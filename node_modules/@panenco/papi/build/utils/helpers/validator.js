"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validator = void 0;
const class_validator_1 = require("class-validator");
const validation_error_1 = require("../../contracts/errors/validation.error");
/**
 * Validates an object with class-validator [[`validate`]]
 * @param object The object to validate
 * @param options validation options
 *
 * @category Helpers
 */
const validator = async (object, options) => {
    const validationErrors = await (0, class_validator_1.validate)(object, options);
    if (validationErrors.length > 0) {
        const errors = validationErrors.reduce(map, {});
        throw new validation_error_1.ValidationError(errors);
    }
};
exports.validator = validator;
const reduce = (errors) => {
    return errors.reduce(map, {});
};
const map = (m, error) => {
    m[error.property] = error.constraints ? Object.values(error.constraints) : reduce(error.children);
    return m;
};
//# sourceMappingURL=validator.js.map