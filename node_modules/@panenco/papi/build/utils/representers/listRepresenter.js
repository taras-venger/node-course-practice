"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.listRepresenter = void 0;
const class_transformer_1 = require("class-transformer");
const contracts_1 = require("../../contracts");
/**
 * @internal
 * Helper to be used on routing-controllers middleware {@link UseBefore} {@link UseAfter}
 *
 * Apply representation transformation on a given input.
 * @param representationType class type of the representation to be used by class-transformer {@link plainToInstance}
 */
const listRepresenter = (representationType) => (_, content) => {
    const [items, count] = content;
    const objects = items.map(item => { var _a, _b; return (_b = (_a = item === null || item === void 0 ? void 0 : item.toJSON) === null || _a === void 0 ? void 0 : _a.call(item)) !== null && _b !== void 0 ? _b : item; });
    const representation = new contracts_1.ListRepresentation(count, objects);
    const listRepresentation = (0, contracts_1.createListRepresentation)(representationType);
    return (0, class_transformer_1.plainToInstance)(listRepresentation, representation, { exposeUnsetFields: false });
};
exports.listRepresenter = listRepresenter;
//# sourceMappingURL=listRepresenter.js.map